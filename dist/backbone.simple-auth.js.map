{"version":3,"sources":["backbone.simple-auth.js"],"names":[],"mappings":";;;;;;AAAA,AAAC,CAAA,UAAU,QAAQ,SAAS;AAC1B,SAAO,YAAY,YAAY,OAAO,WAAW,cAAc,OAAO,UAAU,QAAQ,QAAQ,aAAa,QAAQ,iBACrH,OAAO,WAAW,cAAc,OAAO,MAAM,OAAO,CAAC,YAAY,eAAe,WAChF,OAAO,aAAa,QAAQ,OAAO,UAAU,OAAO;GACpD,MAAM,UAAU,UAAU,SAAS;AAAE;;MAE/B;AASO,aATP,aASU;AACZ,iCAVE,wDAUO;AACT,WAAK;AACL,WAAK;;;cAZH;;yBAAA;AACA;aAAQ,YAAG;AACb,iBAAO;AACL,wBAAY;AACZ,mBAAO;AACP,2BAAe;;;;;AAWnB;;;eAAa,yBAAG;AACd,cAAI,QAAQ,QAAQ,IAAI,KAAK,IAAI;;;AAGjC,cAAI,UAAU,aAAa;AAAE,oBAAQ;;AACrC,eAAK,IAAI;AACP,2BAAe,CAAC,CAAC;AACjB,mBAAO;;AAET,cAAI,CAAC,OAAO;AAAE;;AACd,eAAK,QAAQ,gBAAgB,KAAK,IAAI;;;;;AAIxC;;;eAAM,kBAAG;AACP,kBAAQ,OAAO,KAAK,IAAI;AACxB,eAAK,IAAI;AACP,mBAAO;AACP,2BAAe;;AAEjB,eAAK,QAAQ;;;;;AAIf;;;eAAc,0BAAG;AACf,cAAI,OAAO;AACX,mBAAS,EAAE,UAAU;AACnB,wBAAU,oBAAC,OAAO;AAChB,kBAAI,KAAK,IAAI,kBAAkB;AAC7B,sBAAM,iBAAiB,iBAAiB,YAAY,KAAK,IAAI;;AAE/D,qBAAO;;;;;;;;;WA/CT;KAAmB,SAAS;;AAqDlC,MAAI,uBAAuB;;AAE3B,SAAO","file":"backbone.simple-auth.js","sourcesContent":["(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('backbone'), require('cookies-js')) :\n  typeof define === 'function' && define.amd ? define(['backbone', 'cookies-js'], factory) :\n  global.SimpleAuth = factory(global.Backbone, global.cookies)\n}(this, function (Backbone, cookies) { 'use strict';\n\n  class SimpleAuth extends Backbone.Model {\n    get defaults() {\n      return {\n        cookieName: 'token',\n        token: undefined,\n        authenticated: false\n      };\n    }\n\n    constructor() {\n      super(...arguments);\n      this.determineAuth();\n      this._configureAjax();\n    }\n\n    // Determine if we're authenticated based on the cookie\n    determineAuth() {\n      var token = cookies.get(this.get('cookieName'));\n      // Fix for a bug in cookies-js:\n      // https://github.com/ScottHamper/Cookies/issues/37\n      if (token === 'undefined') { token = undefined; }\n      this.set({\n        authenticated: !!token,\n        token: token\n      });\n      if (!token) { return; }\n      this.trigger('authenticate', this.get('token'));\n    }\n\n    // Log us out by destroying the token\n    logout() {\n      cookies.expire(this.get('cookieName'));\n      this.set({\n        token: undefined,\n        authenticated: false\n      });\n      this.trigger('logout');\n    }\n\n    // Include our token in every request\n    _configureAjax() {\n      var auth = this;\n      Backbone.$.ajaxSetup({\n        beforeSend(jqXHR) {\n          if (auth.get('authenticated')) {\n            jqXHR.setRequestHeader('Authorization', 'Bearer ' + auth.get('token'));\n          }\n          return true;\n        }\n      });\n    }\n  }\n\n  var backbone_simple_auth = SimpleAuth;\n\n  return backbone_simple_auth;\n\n}));\n"],"sourceRoot":"/source/"}